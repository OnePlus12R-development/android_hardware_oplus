type hal_oplus_touch_aidl, domain;
hal_server_domain(hal_oplus_touch_aidl, vendor_hal_oplus_touch)
vndbinder_use(hal_oplus_touch_aidl)

type hal_oplus_touch_aidl_exec, exec_type, vendor_file_type, file_type;
init_daemon_domain(hal_oplus_touch_aidl)

binder_call(vendor_hal_oplus_touch_client, vendor_hal_oplus_touch_server)
binder_call(vendor_hal_oplus_touch_server, vendor_hal_oplus_touch_client)

hal_attribute_hwservice(vendor_hal_oplus_touch, vendor_hal_oplus_touch_hwservice)

allow vendor_hal_oplus_touch_client vendor_hal_oplus_touch_hwservice:hwservice_manager find;

hal_server_domain(hal_oplus_touch_aidl, vendor_hal_oplus_touch)
init_daemon_domain(hal_oplus_touch_aidl)

allow hal_oplus_touch_aidl fingerprint_device:chr_file rw_file_perms;
allow hal_oplus_touch_aidl graphics_device:chr_file rw_file_perms;
allow hal_oplus_touch_aidl fingerprint_device:chr_file rw_file_perms;
r_dir_file(hal_oplus_touch_aidl, vendor_proc_fingerprint)
rw_dir_file(hal_oplus_touch_aidl, vendor_proc_display)
rw_dir_file(hal_oplus_touch_aidl, vendor_sysfs_graphics)
rw_dir_file(hal_oplus_touch_aidl, fingerprint_device)
rw_dir_file(hal_oplus_touch_aidl, vendor_persist_optouch_file)
rw_dir_file(hal_oplus_touch_aidl, vendor_persist_optouch_log_file)
set_prop(hal_oplus_touch_aidl, vendor_optouch_prop)
set_prop(hal_oplus_touch_aidl, system_oplus_touch_prop)

allow hal_oplus_touch_aidl ctl_stop_prop:property_service set;
allow hal_oplus_touch_aidl proc:file read;
allow hal_oplus_touch_aidl servicemanager:binder call;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:dir write;
allow hal_oplus_touch_aidl proc:file open;
allow hal_oplus_touch_aidl servicemanager:binder transfer;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:dir add_name;

allow hal_oplus_touch_aidl hal_oplus_touch_aidl_service:service_manager add;
allow hal_oplus_touch_aidl proc:file getattr;
allow hal_oplus_touch_aidl self:capability sys_nice;
allow hal_oplus_touch_aidl vendor_persist_optouch_file:dir write;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:file create;
allow hal_oplus_touch_aidl vndbinder_device:chr_file read;

allow hal_oplus_touch_aidl input_device:dir search;
allow hal_oplus_touch_aidl vendor_persist_optouch_file:dir add_name;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:dir remove_name;
allow hal_oplus_touch_aidl input_device:chr_file { read write };
allow hal_oplus_touch_aidl vendor_persist_optouch_file:file create;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:file unlink;
allow hal_oplus_touch_aidl input_device:chr_file open;
allow hal_oplus_touch_aidl vendor_persist_optouch_file:file setattr;
allow hal_oplus_touch_aidl vendor_persist_optouch_log_file:file setattr;
allow hal_oplus_touch_aidl self:binder call;
